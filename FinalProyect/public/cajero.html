<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cajero - C치maras</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <header>
    <img src="/img/logo.png" alt="Logo" class="header-logo">
    <nav>
      <ul>
        <li><a href="index.html">Inicio</a></li>
        <li><a href="cajero.html">Cajero</a></li>
        <li><a href="vista_salon.html">Vista Sal칩n</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <h2>P치gina de C치maras</h2>
    <p>Aqu칤 se gestionan los feeds de las c치maras.</p>

    <!-- 游댳 Secci칩n de C치maras -->
    <section id="video-section">
      <h3>Live Feed (Original)</h3>
      <div class="video-container">
        <img src="http://186.119.52.250:5001/video_feed" alt="video_feed">
      </div>
    </section>

    <section id="high-res-frame-section">
      <h3>Captured Plate Frame (High Resolution)</h3>
      <div class="frame-container">
        <img id="highResFrame" src="" alt="High resolution frame">
      </div>
    </section>
  </main>

  <!-- 游댳 Socket para las c치maras y placas detectadas -->
  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
  
    socket.on('updatePlaca', (data) => {
      console.log("Se detect칩 una placa:", data.placa);

      // Mostrar la imagen de alta resoluci칩n si viene en data.frame
      if (data.frame) {
        document.getElementById('highResFrame').src = "data:image/jpeg;base64," + data.frame;
      }

      // (Opcional) Guardar la placa en la BD desde el front si deseas
      fetch('/update', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          placa: data.placa,
          timestamp: data.timestamp
        })
      })
      .then(response => response.json())
      .then(result => {
        if(result.success) {
          console.log("Placa guardada en la BD:", data.placa);
        } else {
          console.warn("No se pudo guardar la placa en la BD:", result.message);
        }
      })
      .catch(error => console.error("Error guardando la placa:", error));
    });
  </script>
</body>
</html>

    